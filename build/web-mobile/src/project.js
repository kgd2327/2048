window.__require=function t(o,i,c){function e(s,a){if(!i[s]){if(!o[s]){var r=s.split("/");if(r=r[r.length-1],!o[r]){var l="function"==typeof __require&&__require;if(!a&&l)return l(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+s+"'")}}var h=i[s]={exports:{}};o[s][0].call(h.exports,function(t){return e(o[s][1][t]||t)},h,h.exports,t,o,i,c)}return i[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<c.length;s++)e(c[s]);return e}({block:[function(t,o,i){"use strict";cc._RF.push(o,"501684Ms1tB3IVvei8PU0Bz","block");var c=function(t){return t&&t.__esModule?t:{default:t}}(t("./color"));cc.Class({extends:cc.Component,properties:{numberLab:cc.Label},onLoad:function(){this.node.on("setNum",this.setNum.bind(this))},start:function(){},setNum:function(t){0==t&&(this.numberLab.node.active=!1),this.numberLab.string=t,t in c.default&&(this.node.color=c.default[t])}}),cc._RF.pop()},{"./color":"color"}],color:[function(t,o,i){"use strict";cc._RF.push(o,"677e43CnFlPwKn/lB6u8M2b","color");var c=[];c[0]=cc.color(192,184,172,225),c[2]=cc.color(235,224,213,225),c[4]=cc.color(234,219,193,225),c[8]=cc.color(240,167,110,225),c[16]=cc.color(244,138,89,225),c[32]=cc.color(245,112,85,225),c[64]=cc.color(245,83,52,225),c[128]=cc.color(234,200,103,225),c[256]=cc.color(234,197,87,225),c[512]=cc.color(234,192,71,225),c[1024]=cc.color(146,208,80,225),c[2048]=cc.color(0,176,240,225),o.exports=c,cc._RF.pop()},{}],game:[function(t,o,i){"use strict";cc._RF.push(o,"a3304PmriJHe5QzABfAaego","game");var c=[2,4];cc.Class({extends:cc.Component,properties:{scoreLab:cc.Label,score:0,blockPrefab:cc.Prefab,interval:20,overFrame:cc.Node,blockParent:cc.Node},onLoad:function(){var t=this;this.drawBgBlock(),this.init(),cc.systemEvent.on("over",function(o){t.init()})},drawBgBlock:function(){this.blockSize=(cc.winSize.width-5*this.interval)/4;var t=this.interval+this.blockSize/2,o=this.blockSize;this.positions=[];for(var i=0;i<4;i++){this.positions.push(new Array(4).fill(0));for(var c=0;c<4;c++){var e=cc.instantiate(this.blockPrefab);e.width=this.blockSize,e.height=this.blockSize,this.blockParent.addChild(e),e.setPosition(cc.v2(t,o)),this.positions[i][c]=cc.v2(t,o),e.emit("setNum",0),t+=this.interval+this.blockSize}t=this.interval+this.blockSize/2,o+=this.interval+this.blockSize}},init:function(){if(this.updateScore(0),this.blocks)for(var t=0;t<4;t++)for(var o=0;o<4;o++)null!=this.blocks[t][o]&&this.blocks[t][o].destroy();this.data=[],this.blocks=[];for(t=0;t<4;t++)this.blocks.push(new Array(4).fill(null)),this.data.push(new Array(4).fill(0));this.addBlock(),this.addBlock(),this.addBlock(),this.addEventHandler()},getEmptyLocation:function(){for(var t=[],o=0;o<this.blocks.length;o++)for(var i=0;i<this.blocks[o].length;i++)null==this.blocks[o][i]&&t.push({x:o,y:i});return t},updateScore:function(t){this.score=t,this.scoreLab.string="\u5206\u6570\uff1a"+this.score},addBlock:function(){var t=this.getEmptyLocation(),o=t[Math.floor(Math.random()*t.length)];if(0==o.length)return!1;var i=o.x,e=o.y,n=this.positions[i][e],s=cc.instantiate(this.blockPrefab),a=c[Math.floor(Math.random()*c.length)];return s.width=this.blockSize,s.height=this.blockSize,this.blockParent.addChild(s),s.setPosition(n),s.emit("setNum",a),this.blocks[i][e]=s,this.data[i][e]=a,!0},addEventHandler:function(){this.node.on("touchstart",this.touchStart,this),this.node.on("touchend",this.touchEnd,this),this.node.on("touchcancel",this.touchEnd,this)},destroyEventHandler:function(){this.node.off("touchstart",this.touchStart,this),this.node.off("touchend",this.touchEnd,this),this.node.off("touchcancel",this.touchEnd,this)},touchStart:function(t){this.startPoint=t.getLocation()},touchEnd:function(t){this.endPoint=t.getLocation();var o=this.endPoint.sub(this.startPoint);o.mag()>50&&(Math.abs(o.x)>Math.abs(o.y)?o.x>0?this.moveRight():this.moveLeft():o.y>0?this.moveUp():this.moveDown())},checkFail:function(){for(var t=0;t<4;t++)for(var o=0;o<4;o++){var i=this.data[t][o];if(0==i)return!1;if(t>0&&i==this.data[t-1][o])return!1;if(t<3&&i==this.data[t+1][o])return!1;if(o>0&&i==this.data[t][o-1])return!1;if(o<3&&i==this.data[t][o+1])return!1;if(2048==i)return!0}return!0},gameOver:function(){this.destroyEventHandler(),this.overFrame.setPosition(cc.v2(0,0))},afterMove:function(t){t&&(this.addBlock(),this.updateScore(this.score+1)),this.checkFail()&&this.gameOver()},moveRight:function(){var t=this;cc.log("r");for(var o=!1,i=[],c=function i(c,e,n){if(3!=e&&0!=t.data[c][e])if(0==t.data[c][e+1]){var s=t.blocks[c][e],a=t.positions[c][e+1];t.blocks[c][e]=null,t.blocks[c][e+1]=s,t.data[c][e+1]=t.data[c][e],t.data[c][e]=0,t.doMove(s,a,function(){i(c,e+1,n)}),o=!0}else{if(t.data[c][e+1]!=t.data[c][e])return void(n&&n());s=t.blocks[c][e],a=t.positions[c][e+1];t.blocks[c][e]=null,t.data[c][e]=0,t.data[c][e+1]*=2,t.blocks[c][e+1].emit("setNum",t.data[c][e+1]),t.doMove(s,a,function(){s.destroy(),n&&n()}),o=!0}else n&&n()},e=0;e<4;e++)for(var n=3;n>=0;n--)0!=this.data[e][n]&&i.push({x:e,y:n});var s=0;for(e=0;e<i.length;e++)c(i[e].x,i[e].y,function(){++s==i.length&&t.afterMove(o)})},doMove:function(t,o,i){var c=cc.moveTo(.1,o),e=cc.callFunc(function(){i&&i()});t.runAction(cc.sequence(c,e))},moveLeft:function(){var t=this;cc.log("l");for(var o=!1,i=[],c=function i(c,e,n){if(0!=e&&0!=t.data[c][e])if(0==t.data[c][e-1]){var s=t.blocks[c][e],a=t.positions[c][e-1];t.blocks[c][e]=null,t.blocks[c][e-1]=s,t.data[c][e-1]=t.data[c][e],t.data[c][e]=0,t.doMove(s,a,function(){i(c,e-1,n)}),o=!0}else{if(t.data[c][e-1]!=t.data[c][e])return void(n&&n());s=t.blocks[c][e],a=t.positions[c][e-1];t.blocks[c][e]=null,t.data[c][e]=0,t.data[c][e-1]*=2,t.blocks[c][e-1].emit("setNum",t.data[c][e-1]),t.doMove(s,a,function(){s.destroy(),n&&n()}),o=!0}else n&&n()},e=0;e<4;e++)for(var n=0;n<4;n++)0!=this.data[e][n]&&i.push({x:e,y:n});var s=0;for(e=0;e<i.length;e++)c(i[e].x,i[e].y,function(){++s==i.length&&t.afterMove(o)})},moveUp:function(){var t=this;cc.log("u");for(var o=!1,i=[],c=function i(c,e,n){if(3!=c&&0!=t.data[c][e])if(0==t.data[c+1][e]){var s=t.blocks[c][e],a=t.positions[c+1][e];t.blocks[c][e]=null,t.blocks[c+1][e]=s,t.data[c+1][e]=t.data[c][e],t.data[c][e]=0,t.doMove(s,a,function(){i(c+1,e,n)}),o=!0}else{if(t.data[c+1][e]!=t.data[c][e])return void(n&&n());s=t.blocks[c][e],a=t.positions[c+1][e];t.blocks[c][e]=null,t.data[c][e]=0,t.data[c+1][e]*=2,t.blocks[c+1][e].emit("setNum",t.data[c+1][e]),t.doMove(s,a,function(){s.destroy(),n&&n()}),o=!0}else n&&n()},e=3;e>=0;e--)for(var n=3;n>=0;n--)0!=this.data[e][n]&&i.push({x:e,y:n});var s=0;for(e=0;e<i.length;e++)c(i[e].x,i[e].y,function(){++s==i.length&&t.afterMove(o)})},moveDown:function(){var t=this;cc.log("d");for(var o=!1,i=[],c=function i(c,e,n){if(0!=c&&0!=t.data[c][e])if(0==t.data[c-1][e]){var s=t.blocks[c][e],a=t.positions[c-1][e];t.blocks[c][e]=null,t.blocks[c-1][e]=s,t.data[c-1][e]=t.data[c][e],t.data[c][e]=0,t.doMove(s,a,function(){i(c-1,e,n)}),o=!0}else{if(t.data[c-1][e]!=t.data[c][e])return void(n&&n());s=t.blocks[c][e],a=t.positions[c-1][e];t.blocks[c][e]=null,t.data[c][e]=0,t.data[c-1][e]*=2,t.blocks[c-1][e].emit("setNum",t.data[c-1][e]),t.doMove(s,a,function(){s.destroy(),n&&n()}),o=!0}else n&&n()},e=0;e<4;e++)for(var n=3;n>=0;n--)0!=this.data[e][n]&&i.push({x:e,y:n});var s=0;for(e=0;e<i.length;e++)c(i[e].x,i[e].y,function(){++s==i.length&&t.afterMove(o)})}}),cc._RF.pop()},{}],overFrame:[function(t,o,i){"use strict";cc._RF.push(o,"8381cGGBzpFqqk8HHpdJ7be","overFrame"),cc.Class({extends:cc.Component,properties:{},start:function(){},onButtonClick:function(t,o){cc.systemEvent.emit("over",{}),this.node.setPosition(cc.v2(720,0))}}),cc._RF.pop()},{}]},{},["block","color","game","overFrame"]);